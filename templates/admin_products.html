<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>إدارة المنتجات - MD Shop</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <!-- رأس الصفحة: الشعار والعنوان -->
  <header>
    <h1 id="mdShopLogo">MD Shop</h1>
    <h2>إدارة المنتجات</h2>
  </header>

  <!-- فقاعات الخلفية -->
  <div class="bubbles-container" id="bubblesContainer"></div>

  <!-- قائمة المنتجات -->
  <div class="products-container">
    {% for product in products %}
      <div class="product-item">
        <h3>{{ product.name }}</h3>
        <p>{{ product.description }}</p>
        <p>المقاسات: {{ product.sizes|join(', ') }}</p>
        <p>الألوان: {{ product.colors|join(', ') }}</p>
        <p>السعر: {{ product.price }}</p>
        {% if product.images %}
          <div class="product-images">
            {% for img in product.images %}
              <img src="{{ img }}" alt="صورة المنتج">
            {% endfor %}
          </div>
        {% endif %}
        <div class="product-actions">
          <button class="edit-btn" onclick="editProduct('{{ product.id }}')">تعديل</button>
          <button class="delete-btn" onclick="deleteProduct('{{ product.id }}')">حذف</button>
        </div>
      </div>
    {% endfor %}
  </div>

  <!-- زر إضافة منتج -->
  <button class="add-product-btn" onclick="openAddProductModal()">&#43;</button>

  <!-- نافذة منبثقة لإضافة/تعديل منتج -->
  <div id="productModal" class="modal">
    <div class="modal-content">
      <span class="close-modal" onclick="closeProductModal()">&times;</span>
      <h2 id="modalTitle">إضافة منتج جديد</h2>
      <!-- حقل مخفي لتخزين معرف المنتج عند التعديل -->
      <input type="hidden" id="productId" name="productId" value="">
      <form id="productForm" method="POST" action="{{ url_for('add_product') }}" enctype="multipart/form-data">
        <div class="form-group">
          <label for="productName">اسم المنتج</label>
          <input type="text" id="productName" name="name" required>
        </div>
        <div class="form-group">
          <label for="productDescription">وصف المنتج</label>
          <textarea id="productDescription" name="description" required></textarea>
        </div>
        <div class="form-group">
          <label>المقاسات</label>
          <div id="sizesContainer">
            <input type="text" id="sizeInput" placeholder="أدخل مقاس">
            <button type="button" class="add-btn" onclick="addSize()">+</button>
          </div>
          <div id="sizesList"></div>
          <input type="hidden" name="sizes" id="sizesHidden">
        </div>
        <div class="form-group">
          <label>الألوان</label>
          <div id="colorsContainer">
            <input type="text" id="colorInput" placeholder="أدخل لون">
            <button type="button" class="add-btn" onclick="addColor()">+</button>
          </div>
          <div id="colorsList"></div>
          <input type="hidden" name="colors" id="colorsHidden">
        </div>
        <div class="form-group">
          <label for="productPrice">السعر</label>
          <input type="number" id="productPrice" name="price" required>
        </div>
        <div class="form-group">
          <label>صور المنتج</label>
          <label class="custom-file-upload">
            <input type="file" id="productImages" name="images" multiple accept="image/*">
            اختر الصور
          </label>
          <div id="imagesPreview"></div>
        </div>
        <button type="submit" id="submitProductBtn">إضافة المنتج</button>
      </form>
    </div>
  </div>

  <!-- تمرير بيانات المنتجات للـ JavaScript -->
  <script>
    var productsData = {{ products|tojson }};
  </script>
  <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>
